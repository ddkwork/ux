<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>树形表格优化版</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: #1a1a1a;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            color: #e0e0e0;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            background: #2d2d2d;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .search-bar {
            background: #333;
            padding: 0.8rem 1rem;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #444;
        }

        .search-input {
            flex-grow: 1;
            background: #2d2d2d;
            border: 1px solid #444;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            color: #e0e0e0;
            font-size: 0.9rem;
        }

        .tools-btn {
            margin-left: 0.8rem;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .tabs {
            display: flex;
            background: #333;
            border-bottom: 1px solid #444;
        }

        .tab {
            padding: 0.6rem 1.2rem;
            cursor: pointer;
            font-size: 0.9rem;
            border-right: 1px solid #444;
        }

        .tab.active {
            background: #2d2d2d;
            color: #4CAF50;
            font-weight: 500;
        }

        .header {
            background: #333;
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #444;
            font-size: 0.85rem;
            color: #aaa;
        }

        .table-container {
            overflow-x: auto;
            max-height: 500px;
        }

        .tree-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8rem;
        }

        .tree-table th, .tree-table td {
            border-right: 1px solid #444;
            border-bottom: 1px solid #444;
            padding: 0.2rem 0.5rem;
            height: 24px;
        }

        .tree-table th:last-child, .tree-table td:last-child {
            border-right: none;
        }

        .tree-table th {
            background-color: #333;
            font-weight: 600;
            color: #e0e0e0;
            text-align: left;
        }

        .tree-table td {
            vertical-align: middle;
        }

        /* 斑马纹效果 */
        .tree-table tbody tr:nth-child(even) {
            background-color: #2d2d2d;
        }

        .tree-table tbody tr:nth-child(odd) {
            background-color: #262626;
        }

        .tree-row {
            transition: background-color 0.2s;
        }

        .tree-row:hover {
            background-color: #3a3a3a !important;
        }

        .tree-cell {
            display: flex;
            align-items: center;
        }

        .tree-indent {
            display: inline-block;
            width: 16px;
            height: 100%;
        }

        .toggle-btn {
            width: 18px;
            height: 18px;
            border: none;
            background: transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 4px; /* 减少间距 */
            cursor: pointer;
            transition: all 0.2s;
            padding: 0;
        }

        .toggle-btn svg {
            width: 16px;
            height: 16px;
            fill: #ffa726;
        }

        .toggle-btn:hover svg {
            fill: #ffb74d;
        }

        .no-toggle {
            width: 18px;
            display: inline-block;
            margin-right: 2px; /* 减少间距 */
        }

        .no-toggle svg {
            width: 16px;
            height: 16px;
            fill: #90a4ae;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 1rem;
            background: #333;
            border-top: 1px solid #444;
        }

        button {
            padding: 0.3rem 0.7rem;
            background: #555;
            color: #e0e0e0;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: background 0.2s;
            font-weight: 500;
            font-size: 0.8rem;
        }

        button:hover {
            background: #666;
        }

        .expand-all {
            background: #388e3c;
        }

        .expand-all:hover {
            background: #43a047;
        }

        .collapse-all {
            background: #d32f2f;
        }

        .collapse-all:hover {
            background: #f44336;
        }

        .filename {
            background: #333;
            padding: 0.5rem 1rem;
            color: #aaa;
            font-size: 0.8rem;
            border-top: 1px solid #444;
        }

        @media (max-width: 768px) {
            body {
                padding: 0.5rem;
            }

            .tree-table {
                font-size: 0.75rem;
            }

            .tree-table th,
            .tree-table td {
                padding: 0.15rem 0.3rem;
            }

            .tree-indent {
                width: 12px;
            }
        }
    </style>
</head>
<body>
<div class="container">

    <div class="search-bar">
        <input type="text" class="search-input" placeholder="搜索...">
        <button class="tools-btn">全局搜索</button>
    </div>

    <div class="header">
        假设统价2.5元/件，翘靶子4元/件计算，具体以实际为准
    </div>

    <div class="table-container">
        <table class="tree-table">
            <thead>
            <tr>
                <th style="width: 20%;">姓名</th>
                <th style="width: 15%;">件数</th>
                <th style="width: 15%;">翘靶子</th>
                <th style="width: 15%;">工钱</th>
                <th style="width: 15%;">状态</th>
            </tr>
            </thead>
            <tbody id="treeTableBody">
            <!-- 树形表格内容将通过JavaScript动态生成 -->
            </tbody>
        </table>
    </div>

    <div class="filename">玉溪2025年10月数据表</div>

    <div class="controls">
        <button class="expand-all" id="expandAll">全部展开</button>
        <button class="collapse-all" id="collapseAll">全部折叠</button>
    </div>
</div>

<script>
    // SVG图标定义
    const svgIcons = {
        folderOpen: `<svg xmlns='http://www.w3.org/2000/svg'  viewBox='0 0 512 512' transform="rotate(90)">
    <!-- 背景色为白色 -->
    <rect width="100%" height="100%" fill="black" />
    <path fill="white"
      d='M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm113.9 231L234.4 103.5c-9.4-9.4-24.6-9.4-33.9 0l-17 17c-9.4 9.4-9.4 24.6 0 33.9L285.1 256 183.5 357.6c-9.4 9.4-9.4 24.6 0 33.9l17 17c9.4 9.4 24.6 9.4 33.9 0L369.9 273c9.4-9.4 9.4-24.6 0-34z' />
</svg>
`,
        folderClosed: `<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'>
\t<path fill="currentColor"
\t\td='M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zm113.9 231L234.4 103.5c-9.4-9.4-24.6-9.4-33.9 0l-17 17c-9.4 9.4-9.4 24.6 0 33.9L285.1 256 183.5 357.6c-9.4 9.4-9.4 24.6 0 33.9l17 17c9.4 9.4 24.6 9.4 33.9 0L369.9 273c9.4-9.4 9.4-24.6 0-34z' />
</svg>
`,
        document: ``
    };

    // 示例数据 - 模拟具有层级结构的数据
    const treeData = [
        {
            id: 1,
            name: "小风",
            count: "85.00",
            qiaobazi: "11.5",
            wage: "258.50",
            status: "已完成",
            children: [
                {
                    id: 2,
                    name: "10月23日工作",
                    count: "45.00",
                    qiaobazi: "6.0",
                    wage: "142.50",
                    status: "已完成",
                    children: []
                },
                {
                    id: 3,
                    name: "10月25日工作",
                    count: "40.00",
                    qiaobazi: "5.5",
                    wage: "116.00",
                    status: "已完成",
                    children: []
                }
            ]
        },
        {
            id: 4,
            name: "杨浩",
            count: "75.00",
            qiaobazi: "11.5",
            wage: "233.50",
            status: "进行中",
            children: [
                {
                    id: 5,
                    name: "10月23日工作",
                    count: "35.00",
                    qiaobazi: "5.5",
                    wage: "116.00",
                    status: "已完成",
                    children: []
                },
                {
                    id: 6,
                    name: "10月28日工作",
                    count: "40.00",
                    qiaobazi: "6.0",
                    wage: "117.50",
                    status: "进行中",
                    children: []
                }
            ]
        },
        {
            id: 7,
            name: "郭加存",
            count: "85.00",
            qiaobazi: "11.5",
            wage: "258.50",
            status: "已完成",
            children: []
        },
        {
            id: 8,
            name: "普智敏",
            count: "70.00",
            qiaobazi: "11.5",
            wage: "221.00",
            status: "已完成",
            children: []
        },
        {
            id: 9,
            name: "李萍翠",
            count: "31.00",
            qiaobazi: "0",
            wage: "77.50",
            status: "未开始",
            children: []
        },
        {
            id: 10,
            name: "毛毛",
            count: "42.00",
            qiaobazi: "0",
            wage: "105.00",
            status: "未开始",
            children: []
        },
        {
            id: 11,
            name: "郑小仙",
            count: "42.00",
            qiaobazi: "0",
            wage: "105.00",
            status: "未开始",
            children: []
        },
        {
            id: 12,
            name: "郑建芳",
            count: "42.00",
            qiaobazi: "0",
            wage: "105.00",
            status: "未开始",
            children: []
        }
    ];

    // 生成树形表格行的函数
    function generateTreeRows(data, level = 0, parentId = null) {
        let rows = '';

        data.forEach(item => {
            const hasChildren = item.children && item.children.length > 0;
            const indent = level * 16;

            // 状态的样式类
            const statusClass = item.status === '已完成' ? 'status-active' :
                item.status === '进行中' ? 'status-active' :
                    item.status === '未开始' ? 'status-inactive' : 'status-pending';

            // 生成行
            rows += `
                <tr class="tree-row level-${level}" data-id="${item.id}" data-parent="${parentId}" data-level="${level}">
                    <td>
                        <div class="tree-cell">
                            <div class="tree-indent" style="width: ${indent}px;"></div>
                            ${hasChildren ?
                `<button class="toggle-btn" data-id="${item.id}" data-expanded="false" title="展开/折叠">${svgIcons.folderClosed}</button>` :
                `<span class="no-toggle" title="无子项">${svgIcons.document}</span>`
            }
                            ${item.name}
                        </div>
                    </td>
                    <td>${item.count}</td>
                    <td>${item.qiaobazi}</td>
                    <td>${item.wage}</td>
                    <td><span class="${statusClass}">${item.status}</span></td>
                </tr>
                `;

            // 递归生成子行
            if (hasChildren) {
                rows += generateTreeRows(item.children, level + 1, item.id);
            }
        });

        return rows;
    }

    // 初始化表格
    function initTreeTable() {
        const tableBody = document.getElementById('treeTableBody');
        tableBody.innerHTML = generateTreeRows(treeData);

        // 添加展开/折叠事件监听
        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const itemId = this.getAttribute('data-id');
                const isExpanded = this.getAttribute('data-expanded') === 'true';
                toggleChildren(itemId, this, isExpanded);
            });
        });

        // 添加全部展开/折叠按钮事件
        document.getElementById('expandAll').addEventListener('click', expandAll);
        document.getElementById('collapseAll').addEventListener('click', collapseAll);

        // 标签切换
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function () {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // 更新时间
        updateTime();
        setInterval(updateTime, 60000);
    }

    // 更新当前时间
    function updateTime() {
        const now = new Date();
        const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
        document.getElementById('current-time').textContent = timeString;
    }

    // 切换子项显示/隐藏
    function toggleChildren(itemId, button, isExpanded) {
        const rows = document.querySelectorAll(`tr[data-parent="${itemId}"]`);

        rows.forEach(row => {
            if (isExpanded) {
                row.style.display = 'none';
                // 递归隐藏所有子项
                const childId = row.getAttribute('data-id');
                const childRows = document.querySelectorAll(`tr[data-parent="${childId}"]`);
                childRows.forEach(childRow => {
                    childRow.style.display = 'none';
                    // 更新子项的按钮状态
                    const childButton = childRow.querySelector('.toggle-btn');
                    if (childButton) {
                        childButton.setAttribute('data-expanded', 'false');
                        childButton.innerHTML = svgIcons.folderClosed;
                    }
                });
            } else {
                row.style.display = '';
            }
        });

        // 切换按钮图标和状态
        if (isExpanded) {
            button.innerHTML = svgIcons.folderClosed;
            button.setAttribute('data-expanded', 'false');
        } else {
            button.innerHTML = svgIcons.folderOpen;
            button.setAttribute('data-expanded', 'true');
        }
    }

    // 展开所有行
    function expandAll() {
        document.querySelectorAll('.tree-row').forEach(row => {
            row.style.display = '';
        });

        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.setAttribute('data-expanded', 'true');
            btn.innerHTML = svgIcons.folderOpen;
        });
    }

    // 折叠所有行（只显示第一级）
    function collapseAll() {
        document.querySelectorAll('.tree-row').forEach(row => {
            const level = parseInt(row.getAttribute('data-level'));
            if (level > 0) {
                row.style.display = 'none';
            }
        });

        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.setAttribute('data-expanded', 'false');
            btn.innerHTML = svgIcons.folderClosed;
        });
    }

    // 页面加载完成后初始化表格
    document.addEventListener('DOMContentLoaded', initTreeTable);
</script>
</body>
</html>
